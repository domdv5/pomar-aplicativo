<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet"type="text/css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
  <link rel="stylesheet" href='/resources/assets/css/login1.css'>
  <link href="/resources/assets/css/styles.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!--  estilos datables basico -->
  <!--   <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css">
    <script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script type="text/javascript" language="javascript"
        src="https://cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js"></script> -->
  <!--  estilos datables basico -->

  <!-- estilos datables bootstrap5 -->
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap.min.css"> -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap5.min.css">

  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap5.min.js"></script>
  <!-- estilos datables bootstrap5 -->

  <!-- paneles de busqueda -->
  <link rel="stylesheet" href="https://cdn.datatables.net/searchpanes/1.3.0/css/searchPanes.dataTables.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/select/1.3.3/css/select.dataTables.min.css">

  <script src="https://cdn.datatables.net/searchpanes/1.3.0/js/dataTables.searchPanes.min.js"></script>
  <script src="https://cdn.datatables.net/select/1.3.3/js/dataTables.select.min.js"></script>
  <!-- paneles de busqueda -->

  <!-- exportar a excel -->
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.7.1/css/buttons.dataTables.min.css">
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/dataTables.buttons.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/1.7.1/js/buttons.html5.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/datatables-buttons-excel-styles@1.1.5/js/buttons.html5.styles.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/datatables-buttons-excel-styles@1.1.5/js/buttons.html5.styles.templates.min.js"></script>
  <!-- exportar a excel -->


  <link rel="icon" href="/resources/assets/images/database-storage.svg">

  <title>Sistema</title>
</head>

<body class=" font-size: small">
  <div class="navbar navbar-danger bg-light">

    <div class="d-flex flex-row bd-highlight mb-3">
      <a class="navbar-brand p-1" href="/crud">
        <img src="/resources/assets/images/database-storage.svg" alt="" width="60" height="40">
      </a>
    </div>

    <div class="d-flex flex-row bd-highlight mb-3">
      <div class="p-2 bd-highlight">
        <div class="container-fluid justify-content-start">
          <a class="btn btn-sm btn-outline-primary" href="/logout">Cerrar sesion</a>
        </div>
      </div>
      <div class="p-2 bd-highlight">
        <form class="container-fluid justify-content-start">
          <button class="btn btn-sm btn-outline-primary" type="button" data-bs-toggle="modal"
            data-bs-target="#exampleModal" data-bs-whatever="@fat">Añadir nuevo usuario</button>
        </form>
      </div>

    </div>
  </div>

  <!-- Masthead-->
  <header class="masthead bg-primary text-white text-center">
    <div class="container d-flex align-items-center flex-column">
      <!-- Masthead Avatar Image-->
      <img class="masthead-avatar mb-5" src="/resources/assets/img/avataaars.svg" alt="..." />
      <!-- Masthead Heading-->
      <h1 class="masthead-heading text-uppercase mb-0">Bienvenido, ADMIN</h1>
      <!-- Icon Divider-->
      <div class="divider-custom divider-light">
        <div class="divider-custom-line"></div>
        <div class="divider-custom-icon"><i class="fas fa-user-cog"></i></div>
        <div class="divider-custom-line"></div>
      </div>
      <!-- Masthead Subheading-->
      <p class="masthead-subheading font-weight-light mb-0">SISTEMA DE GESTIÓN DE USUARIOS</p>
    </div>
  </header>
  <!--     <nav class="navbar navbar-light bg-primary">
        <form class="container-fluid justify-content-start">
            <button class="btn btn-sm btn-outline-light" type="button" data-bs-toggle="modal"
                data-bs-target="#exampleModal" data-bs-whatever="@fat">Anadir nuevo usuario</button>
            </form>
            <form method="post" action="/filter" class="container-fluid justify-content-start">
                <input type="submit" value="Ver unicamente usuarios no restringidos" class="btn btn-sm btn-outline-light">
            </form>
    </nav> -->


  <!-- <div class="d-flex justify-content-center">
    <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
          Opciones
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
          <li><a class="dropdown-item" href="#">Action</a></li>
          <li><a class="dropdown-item" href="#">Another action</a></li>
          <li><a class="dropdown-item" href="#">Something else here</a></li>
        </ul>
      </div>
</div> -->




  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Anadir usuario</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form method="post" action="/add">

            <div class="mb-3">
              <label for="message-text" class="col-form-label">id</label>
              <input class="form-control" id="ident" type="number" name="id_users">
            </div>

            <div class="mb-3">
              <label for="message-text" class="col-form-label">Primer Nombre</label>
              <input class="form-control" id="message-text" type="text" name="primer_nombre">
            </div>

            <div class="mb-3">
              <label for="message-text" class="col-form-label">Segundo Nombre</label>
              <input class="form-control" id="message-text" type="text" name="segundo_nombre">
            </div>

            <div class="mb-3">
              <label for="message-text" class="col-form-label">Primer Apellido</label>
              <input class="form-control" id="message-text" type="text" name="primer_apellido">
            </div>

            <div class="mb-3">
              <label for="message-text" class="col-form-label">Segundo Apellido</label>
              <input class="form-control" id="message-text" type="text" name="segundo_apellido">
            </div>

            <div class="mb-3">
              <label for="message-text" class="col-form-label">Direccion</label>
              <input class="form-control" id="message-text" type="text" name="direccion">
            </div>

            <div class="mb-3">
              <label for="message-text" class="col-form-label">Telefono</label>
              <input class="form-control" id="message-text" type="tel" name="telefono">
            </div>

            <div class="mb-3">
              <label for="message-text" class="col-form-label">Celular</label>
              <input class="form-control" id="message-text" type="tel" name="celular">
            </div>

            <div class="mb-3">
              <label for="exampleFormControlTextarea1" class="form-label">Observaciones</label>
              <textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="observaciones"></textarea>
            </div>

            <div class="input-group mb-3">
              <label class="input-group-text" for="inputGroupSelect01">Comite</label>
              <select class="form-select" id="inputGroupSelect01" name="id_comite">
                <option selected value=1>Empresarial</option>
                <option value=2>Deportes</option>
                <option value=3>Mujer</option>
                <option value=4>Salud</option>
                <option value=5>Obras</option>
              </select>
            </div>


            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              <button type="submit" id="boton" class="btn btn-primary">Enviar</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  </div>
  </div>
  </div>

  <div class="container mt-3 ">
    <div class="row">
      <div class="col">
        <table class="table table-striped table-bordered table-lg" cellspacing="0" width="100%" id="myTable">
          <thead>
            <th class="table-light" align="center" valign="middle">Id</th>
            <th class="table-light" align="center" valign="middle">Primer Nombre</th>
            <th class="table-light" align="center" valign="middle">Segundo Nombre</th>
            <th class="table-light" align="center" valign="middle">Primer Apellido</th>
            <th class="table-light" align="center" valign="middle">Segundo Apellido</th>
            <th class="table-light" align="center" valign="middle">Direccion</th>
            <th class="table-light" align="center" valign="middle">Telefono</th>
            <th class="table-light" align="center" valign="middle">Celular</th>
            <th class="table-light" align="center" valign="middle">Observaciones</th>
            <th class="table-light" align="center" valign="middle">Comite</th>
            <th class="table-light" align="center" valign="middle">Acciones</th>
          </thead>
          <tbody>
            <% for (var i=0; i < data.length; i++) { %>
              <tr>
                <td align="center" valign="middle">
                  <%= data[i].id_users%>
                </td>
                <td align="center" valign="middle">
                  <%= data[i].primer_nombre%>
                </td>
                <td align="center" valign="middle">
                  <%= data[i].segundo_nombre%>
                </td>
                <td align="center" valign="middle">
                  <%= data[i].primer_apellido%>
                </td>
                <td align="center" valign="middle">
                  <%= data[i].segundo_apellido%>
                </td>
                <td align="center" valign="middle">
                  <%= data[i].direccion%>
                </td>

                <td align="center" valign="middle">
                  <%= data[i].telefono%>
                </td>

                <td align="center" valign="middle">
                  <%= data[i].celular%>
                </td>

                <td align="center" valign="middle">
                  <%= data[i].observaciones%>
                </td>

                <td align="center" valign="middle">
                  <%= data[i].nombre%>
                </td>

                <td align="center" valign="middle">
                  <div class="d-flex flex-column bd-highlight mb-3">
                    <div class="p-2 bd-highlight">
                      <div class="d-flex justify-content-end">

                        <button type="button" class="btn btn-primary m-1"
                          style="display: flex;align-items: center;justify-content: center;" data-bs-toggle="modal"
                          data-bs-target="#exampleModal<%= data[i].id_users%>">
                          <span class="material-icons">edit</span>
                        </button>

                        <button type="button" class="btn btn-danger m-1"
                          style="display: flex;align-items: center;justify-content: center;" data-bs-toggle="modal"
                          data-bs-target="#modalEliminar<%= data[i].id_users%>">
                          <span class="material-icons">delete_forever</span>
                        </button>
                      </div>
                    </div>

                  </div>






      </div>
      <!--                                     <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal"
                                        data-bs-target="#modalEliminar<%= data[i].id_user%>">
                                        Eliminar
                                    </button>

                                    <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal"
                                        data-bs-target="#exampleModal<%= data[i].id_user%>"
                                        data-bs-whatever="@fat">Editar Entrada</button> -->
      </td>

      <div class="modal fade" id="modalEliminar<%= data[i].id_users%>" tabindex="-1" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Eliminar usuario</h5>
              <button type="button" class="btn-close btn-primary" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              Confimar eliminación
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              <a href="/delete/<%= data[i].id_users%>" class="btn btn-primary">Aceptar</a>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="exampleModal<%= data[i].id_users%>" tabindex="-1" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Editar
                Datos</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form method="post" action="/edit/<%=data[i].id_users%>">
                <div class="mb-3">
                  <label for="message-text" class="col-form-label">id</label>
                  <input class="form-control" id="message-text" type="text" name="id_users" 
                  value="<%= data[i].id_users %>">
                </div>

                <div class="mb-3">
                  <label for="message-text" class="col-form-label">Primer Nombre</label>
                  <input class="form-control" id="message-text" type="text" name="primer_nombre"
                    value="<%= data[i].primer_nombre %>">
                </div>

                <div class="mb-3">
                  <label for="message-text" class="col-form-label">Segundo Nombre</label>
                  <input class="form-control" id="message-text" type="text" name="segundo_nombre"
                    value="<%= data[i].segundo_nombre %>">
                </div>

                <div class="mb-3">
                  <label for="message-text" class="col-form-label">Primer Apellido</label>
                  <input class="form-control" id="message-text" type="text" name="primer_apellido"
                    value="<%= data[i].primer_apellido %>">
                </div>

                <div class="mb-3">
                  <label for="message-text" class="col-form-label">Segundo APellido</label>
                  <input class="form-control" id="message-text" type="text" name="segundo_apellido"
                    value="<%= data[i].segundo_apellido %>">
                </div>

                <div class="mb-3">
                  <label for="message-text" class="col-form-label">Direccion</label>
                  <input class="form-control" id="message-text" type="text" name="direccion"
                    value="<%= data[i].direccion %>">
                </div>

                <div class="mb-3">
                  <label for="message-text" class="col-form-label">Telofono</label>
                  <input class="form-control" id="message-text" type="number" name="telefono"
                    value="<%= data[i].telefono%>">
                </div>

                <div class="mb-3">
                  <label for="exampleFormControlTextarea1" class="form-label">Celular</label>
                  <input class="form-control" type="number" name="celular" value="<%= data[i].celular %> "
                    id="exampleFormControlTextarea1" rows="3"></textarea>
                </div>

                <div class="mb-3">
                  <label for="exampleFormControlTextarea1" class="form-label">Observaciones</label>
                  <input class="form-control" type="text" name="observaciones" value="<%= data[i].observaciones %> "
                    id="exampleFormControlTextarea1" rows="3"></textarea>
                </div>

                <div class="input-group mb-3">
                  <label class="input-group-text" for="inputGroupSelect01">Comite</label>
                  <select class="form-select" id="inputGroupSelect01" name="id_comite">
                    <option selected value=<%= data[i].id_comite %> >
                      <%= data[i].nombre%>
                    </option>
                    <% if(data[i].id_comite === 1) { %>
                      <option value=2>Deportes</option>
                      <option value=3>Mujer</option>
                      <option value=4>Salud</option>
                      <option value=5>Obras</option>
                      <% } %>

                        <% if(data[i].id_comite === 2 ) { %>
                          <option value=1>Empresarial</option>
                          <option value=3>Mujer</option>
                          <option value=4>Salud</option>
                          <option value=5>Obras</option>
                          <% } %>

                            <% if(data[i].id_comite=== 3) { %>
                              <option value=1>Empresarial</option>
                              <option value=2>Deportes</option>
                              <option value=4>Salud</option>
                              <option value=5>Obras</option>
                              <% } %>

                                <% if(data[i].id_comite===4 ) { %>
                                  <option value=1>Empresarial</option>
                                  <option value=2>Deportes</option>
                                  <option value=3>Mujer</option>
                                  <option value=5>Obras</option>
                                  <% } %>

                                    <% if(data[i].id_comite===5 ) { %>
                                      <option value=1>Empresarial</option>
                                      <option value=2>Deportes</option>
                                      <option value=3>Mujer</option>
                                      <option value=4>Salud</option>
                                      <% } %>

                                  
                  </select>
                </div>

                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                  <button type="submit" class="btn btn-primary">Enviar</button>
                </div>
              </form>
              </tr>
              <% } %>
                </tbody>
                </table>

                <script>
                  $(document).ready(function () {
                    $('#myTable').DataTable({
                      "language": {
                        "url": "https://cdn.datatables.net/plug-ins/1.10.25/i18n/Spanish.json",
                      },
                      "dom": 'Bfrtlip',
                      "buttons":{
                        "dom":{
                          "button":{
                            "className": 'btn'
                          }
                        },
                        "buttons":[{
                          "extend":"excel",
                          "text": '<i class="fas fa-file-excel"></i>',
                          "className": 'btn btn-outline-success mb-1',
                          "titleAttr": 'Exportar a Excel',
                          "excelStyles":{
                            "template": 'green_medium'
                          }
                        }]
                      }
                    });
                  });
                </script>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.startbootstrap.com/sb-forms-latest.js"></script>
    <script src="/resources/js/script.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="/resources/assets/js/comprobacion"></script>


    <% if(typeof alert !="undefined" ) {%>
      <script>
        Swal.fire({
          position: '<%= position%>',
          icon: '<%= icon%>',
          title: '<%= title%>',
          showConfirmButton: '<%= showConfirmButton%>',
          timer: '<%= timer%>',
          width: '<%= width%>',
          heightAuto: '<%= heightAuto%>',
          height: '<%= height%>'
        }).then(() => {
          window.location = '/<%=ruta %>'
        })
      </script>
      <% } %>


</body>


</html>